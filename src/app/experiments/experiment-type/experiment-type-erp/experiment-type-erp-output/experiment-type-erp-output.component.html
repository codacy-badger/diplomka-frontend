<div [formGroup]="form">
  <div formArrayName="outputs">
    <div *ngFor="let output of outputs | experimentTypeErpOutputCount:count; let i=index">
      <div class="row experiment-property" [attr.data-content]="(i+1) + '.'" [formGroupName]="i">
        <div class="d-none d-md-block col-md-12">
          <h5>Pulse</h5>
        </div>
        <div class="col-12 col-sm-6 col-md-3">
          <div class="form-group">
            <label [for]="'pulse-up_' + i" class="d-none d-md-block">up [ms]</label>
            <label [for]="'pulse-up_' + i" class="d-md-none">Pulse - up [ms]</label>
            <input type="number" [id]="'pulse-up_' + i" class="form-control form-control-sm" formControlName="pulseUp" [class.is-valid]="pulseUp(i).valid" [class.is-invalid]="pulseUp(i).invalid">
            <small *ngIf="pulseUp(i).touched && pulseUp(i).errors?.required" class="form-text text-muted">Hodnota nesmí být prázdná!</small>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-md-3">
          <div class="form-group">
            <label [for]="'pulse-down_' + i" class="d-none d-md-block">down [ms]</label>
            <label [for]="'pulse-down_' + i" class="d-md-none">Pulse - down [ms]</label>
            <input type="number" [id]="'pulse-down_' + i" class="form-control form-control-sm" formControlName="pulseDown" [class.is-valid]="pulseDown(i).valid" [class.is-invalid]="pulseDown(i).invalid">
            <small *ngIf="pulseDown(i).touched && pulseDown(i).errors?.required" class="form-text text-muted">Hodnota nesmí být prázdná!</small>
          </div>
        </div>

        <div class="col-12 col-sm-6 col-md-3">
          <div class="form-group">
            <label [for]="'distribution_' + i">distribution [%]</label>
            <ng5-slider [id]="'distribution_' + i" formControlName="distribution" [formControl]="distribution(i)" [options]="distributionSliderOptions[i]"></ng5-slider>
            <small *ngIf="distribution(i).touched && distribution(i).errors?.required" class="form-text text-muted">Hodnota nesmí být prázdná!</small>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-md-3">
          <div class="form-group">
            <label [for]="'brightness_' + i">brightness [%]</label>
            <ng5-slider [id]="'brightness_' + i" formControlName="brightness" [options]="brightnessSliderOptions"></ng5-slider>
            <small *ngIf="brightness(i).touched && brightness(i).errors?.required" class="form-text text-muted">Hodnota nesmí být prázdná!</small>
          </div>
        </div>

        <div class="col-12" formArrayName="dependencies">
          <div class="form-group">
            <label [for]="'dependency_' + i">dependencies</label>
            <div>
            <span class="dependency badge badge-info"
                  *ngFor="let dependency of dependencies(i).value"
                  title="Odstranit">{{dependency | experimentTypeErpOutputDependency}}
              <i class="fas fa-trash" (click)="handleRemoveDependency(i, dependency)"></i></span>
            <input type="text" [id]="'dependency_' + i"
                   class="dependency form-control form-control-sm"
                   placeholder="stimul x count" #input
                   [formControlName]="'1'"
                   (keyup)="handleDependencyKeyUp($event, i, input.value)"
                   [class.is-invalid]="dependencyValue(i).invalid">
              <small *ngIf="dependencyValue(i).touched && dependencyValue(i).errors?.invalidDependency" class="form-text text-muted">Číslo závislosti je vyšší, než počet výstupů!</small>
              <small *ngIf="dependencyValue(i).touched && dependencyValue(i).errors?.invalidValue" class="form-text text-muted">Číslo závislosti je neplatné!</small>
            </div>
          </div>
        </div>

        <div class="col-12">
          <app-output-type [form]="outputType(i)"></app-output-type>
        </div>

      </div>
    </div>
  </div>
</div>
